---
- name: Add a service block to services.yaml
  tags: homepage
  ansible.builtin.blockinfile:
    state: present
    insertafter: "{{ homepage_config.category }}:"
    dest: "{{ base_directory }}/homepage/config/services.yaml"
    marker: "  # {mark} {{ homepage_config.service_name | default(service_directory | capitalize) | upper }} CONFIGURATION"
    content: |2
        - {{ homepage_config.service_name | default(service_directory | capitalize) }}:
            href: "https://{{ homepage_config.url | default(expanded_url) }}"
            description: "{{ homepage_config.description | default('') }}"
            icon: "{{ homepage_config.icon | default('') }}"
            server: docker
            container: "{{ homepage_config.container | default(service_directory) }}"
